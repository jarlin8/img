!function(a){"use strict";jQuery(document).ready(function(a){function t(){a(".alp-table-addcol-type").length&&null!=wp.editor&&a("#alp-table-add-column .alp-table-addcol-type").select2({placeholder:"Select a Column Type",allowClear:!0,dropdownParent:a("#alp-table-add-column")})}function e(){a(".amalinkspro-comparison-table-admin").find("tbody tr").each(function(t){var e=a(this).find("td:last-child").html('<span class="alp-table-td-editable"><span>Click to Edit</span><i class="icon-amalinkspro-edit"></i></span>').removeClass("no-data-yet"),l="",i=e.attr("data-alp-table-td-type");if("cta-btn"===i){var s=a(".alp-table-title").attr("data-alp-cta-default");l='<span class="alp-table-td-ctabtn-editable"><a class="amalinkspro-cta-btn" href="#" target="_blank" rel="nofollow">Click Here</a><i class="icon-amalinkspro-edit"></i></span>'}"image-sitestripe"===i?(l='<i class="icon-amalinkspro-edit js-edit-table-image-sitestripe"></i>',l+='<span class="alp-sitestripe-tb-col-html"></span>'):l='<span class="alp-table-td-editable"><span>Click to Edit</span><i class="icon-amalinkspro-edit"></i></span>',e.html(l).removeClass("no-data-yet")}),n(),a("#alp-table, .alp-table-editor-add-column, .alp-table-editor-add-row").css("pointerEvents","all")}function l(t){console.log("table_asins: "),console.log(t);var e={action:"alp_paapi5_get_asin_groups_data",asins:t};a.ajax({type:"POST",url:ajaxurl,data:e,success:function(t){function e(a){try{JSON.parse(a)}catch(a){return!1}return!0}if(console.log("add column response:"),console.log(t),t&&e(t)){var l=JSON.parse(t);a(".amalinkspro-comparison-table-admin").find("tbody tr").each(function(t){if(console.log("response_obj: "),console.log(l),l.error&&""!==l.error){var e,s="-";(e=a(this).find("td:last-child")).html(s)}else{var o=a(this).attr("alp-data-asin"),e,n=(e=a(this).find("td:last-child")).attr("data-alp-table-td-type"),s=i(l,n,o);if("price-list"===n||"price-offer"===n||"price-lowest-new-price"===n||"price-lowest-used-price"===n){var r=s.replace(/\D/g,"");e.attr("data-sort-value",r)}if("cta-btn"===n?s='<span class="alp-table-td-ctabtn-editable">'+s+'<i class="icon-amalinkspro-edit"></i></span>':"custom"!==n&&"title"!==n&&"brand"!==n&&"model"!==n&&"manufacturer"!==n&&"upc"!==n&&"warranty"!==n&&"author"!==n&&"binding"!==n&&"edition"!==n&&"number-of-pages"!==n&&"publication-date"!==n&&"publisher"!==n&&"release-date"!==n&&"studio"!==n||(s='<span class="alp-table-td-editable">'+s+'<i class="icon-amalinkspro-edit"></i></span>'),s){var d=e.index(),p=a("table#alp-table thead tr.th-settings").find("th:nth-child("+d+")").attr("data-alp-table-v-align"),c=a("table#alp-table thead tr.th-settings").find("th:nth-child("+d+")").attr("data-alp-table-h-align");e.html(s).removeClass("no-data-yet").css({verticalAlign:p,textAlign:c})}else e.html("Error: Delete this column")}})}else alert("There was a problem with the Amazon API. Please try again.")},complete:function(t){console.log("add column complete response:"),console.log(t),n(),a("#alp-table, .alp-table-editor-add-column, .alp-table-editor-add-row").css("pointerEvents","all")}})}function i(t,e,l){var i;if(console.log(e),console.log(l),console.log(t),!t&&!e&&!l)return i="Error: Delete this column";if(t&&t[l]&&t[l].detailPageURL)var s=t[l].detailPageURL;else var s="";if(t[l])if("price-offer"===e||"price-list"===e)if(t[l].offerDisplay)var i='<span class="alp-price-offer">'+t[l].offerDisplay+"</span>";else var i="N/A";else if("image"===e){if(t[l].title)var o=t[l].title;else var o="Product Image";if(t[l].primaryImgUrlMd&&o)var i='<img src="'+t[l].primaryImgUrlMd+'" alt="'+o+'" />';else if(t[l].primaryImgUrlSm&&o)var i='<img src="'+t[l].primaryImgUrlSm+'" alt="'+o+'" />';else if(t[l].primaryImgUrlLg&&o)var i='<img src="'+t[l].primaryImgUrlLg+'" alt="'+o+'" />';else var i="N/A"}else if("cta-btn"===e)if(s)var n,i='<a class="amalinkspro-cta-btn" href="'+s+'" target="_blank" rel="nofollow">'+a(".alp-table-title").attr("data-alp-cta-default")+"</a>";else var i="Error: Delete this Row";else if("brand"===e)if(t[l].brand)var i=t[l].brand;else var i="N/A";else if("model"===e)if(t[l].model)var i=t[l].model;else var i="N/A";else if("warranty"===e)if(t[l].warranty)var i=t[l].warranty;else var i="N/A";else if("title"===e)if(t[l].title)var i=t[l].title;else var i="N/A";else if("prime"===e)if(!0===t[l].prime)var i='<span class="alp-prime-eligible-tag"><span class="alp-prime-eligible-tag-top">Prime</span><span class="alp-prime-eligible-tag-bottom">Eligible</span></span>';else var i='<span class="alp-prime-eligible-tag not-eligible"><span class="alp-prime-eligible-tag-top">Prime</span></span>';else if("author"===e)if(t[l].author)var i=t[l].author;else var i="N/A";else if("number-of-pages"===e)if(t[l].pagesCount)var i=t[l].pagesCount;else var i="N/A";else if("publication-date"===e)if(t[l].publicationDate)var i=t[l].publicationDate;else var i="N/A";else if("release-date"===e)if(t[l].releaseDate)var i=t[l].releaseDate;else var i="N/A";else if("custom"===e)var i="<span>Click to Edit</span>";else var i="Error: Delete This Column";else var i="<span>Click to Edit</span>";return i}function s(t){var e={action:"amalinkspro_load_table_link_settings",table_id:t};a.ajax({type:"POST",url:ajaxurl,data:e,dataType:"json",success:function(t){if(console.log("link settings: "),console.log(t),t){var e=a(".amalinkspro-tablebuilder-sidebar").find(".amalinkspro-tablebuilder-sidebar-settings-basic");if(t.affiliate_id){var l=t.affiliate_id;e.find(".amalinkspro-table-choose-associate-id-select").val(l).attr("selected","selected")}"on"==t.new_tab?e.find("input#alp-new-window").prop("checked",!0):e.find("input#alp-new-window").prop("checked",!1),"on"==t.nofollow?e.find("input#alp-nofollow").prop("checked",!0):e.find("input#alp-nofollow").prop("checked",!1),"on"==t.add_to_cart?e.find("input#alp-addtocart").prop("checked",!0):e.find("input#alp-addtocart").prop("checked",!1)}},complete:function(t){a(".amalinkspro-tablebuilder-sidebar-settings").fadeIn(200)}})}function o(t,e){var l={action:"amalinkspro_load_table_into_editor",table_id:t};a.ajax({type:"POST",url:ajaxurl,data:l,success:function(t){t&&(a(".alp-table-wrapper.amalinkspro-tablebuilder-table").prepend(t),a(".alp-table-editor-add-column").fadeIn(100))},complete:function(t){a(".amalinkspro-tablebuilder-table-post-editor").hide(),a(".amalinkspro-tablebuilder-tablebuilder, .amalinkspro-tablebuilder-sidebar").fadeIn(50,function(){}),n(),r(),a("#amalinkspro-tablebuilder .amalinkspro-media-window-title").find("h1").html("Editing Table #"+l.table_id+" - "+e),a(".amalinkspro-tablebuilder-loading-overlay").fadeOut(300)}})}function n(){if(a("table#alp-table").length){var t='<span class="alp-top-pick"><span class="alp-top-pick-text">Top</span><span class="alp-top-pick-angle"></span></span>';a("table#alp-table").dragtable({dragHandle:".icon-amalinkspro-drag",dragaccept:".draggable",beforeStart:function(){a("#alp-table").find("tbody tr td .alp-top-pick").remove()},beforeMoving:function(){a("th.draggable").find(".alp-table-editor-col-settings").fadeOut(50),a("#alp-table").find("thead tr.th-settings th").css("position","static"),a("#alp-table").find("thead tr.alp-table-headings th").css("position","static"),a("#alp-table").find("tbody tr td").css("position","static")},beforeStop:function(){a("#alp-table").find("thead tr.th-settings th").css("position","relative"),a("#alp-table").find("thead tr.alp-table-headings th").css("position","relative"),a("#alp-table").find("tbody tr td").css("position","relative"),a("#alp-table").find("tbody tr td:nth-child(2)").append(t)}})}}function r(){a("table#alp-table").length&&a("table#alp-table").find("tbody").sortable({handle:".icon-amalinkspro-drag",axis:"y",cursor:"ns-resize"})}function d(){var t=a("#alp-table"),e=0,l=0,i=0,s=0,o=0,n=0,r=0;t.find("thead tr:nth-child(2) th").resizable({handles:"e",minWidth:120,start:function(t,s){r=a(this).resizable("option","minWidth"),e=a(this).width(),l=e,o=s.element.parents(".alp-table-wrapper").find("table#alp-table").width(),i=t.pageX,a(this).attr("style","position: relative;"),a(".alp-table-headings th").css("pointerEvents","none")},stop:function(t,e){a(this).attr("data-alp-table-col-width",e.size.width),a(".alp-table-headings th").css("pointerEvents","all")},resize:function(a,t){var e=a.pageX-i;if(t.element.width()!=l||e>0){l=t.element.width();var n=t.element.parents(".alp-table-wrapper").find("table#alp-table"),r=Number(l)-Number(t.originalSize.width);s=Number(o)+e,n.width(s)}}})}function p(a){}function c(t){a.ajax({type:"POST",url:ajaxurl,data:t,success:function(t){function e(a){try{JSON.parse(a)}catch(a){return!1}return!0}console.log("response: "),console.log(t);var l="";if(t)if(e(t)){var i=JSON.parse(t);if(console.log("XXX response_obj: "),console.log(i),i&&i.SearchResult&&i.SearchResult.Items){var s=i.SearchResult.Items,o;for(o=0;o<s.length;o++){var n="",r="",d="";s[o]&&s[o].ASIN&&(n=s[o].ASIN,r=alpAmazonUrl+"/dp/"+n),s[o]&&s[o].DetailPageURL&&(d=s[o].DetailPageURL);var p="";s[o]&&s[o].ItemInfo&&s[o].ItemInfo.Title&&s[o].ItemInfo.Title.DisplayValue&&(p=s[o].ItemInfo.Title.DisplayValue);var c="X";if(s[o]&&s[o].Offers&&s[o].Offers.Listings[0]&&s[o].Offers.Listings[0].DeliveryInfo&&s[o].Offers.Listings[0].DeliveryInfo.IsPrimeEligible&&!0===s[o].Offers.Listings[0].DeliveryInfo.IsPrimeEligible)c='<span class="alp-prime-eligible-tag"><span class="alp-prime-eligible-tag-top">Prime</span><span class="alp-prime-eligible-tag-bottom">eligible</span></span>';else var c='<span class="alp-prime-eligible-tag not-eligible"><span class="alp-prime-eligible-tag-top">Prime</span></span>';var b="";s[o]&&s[o].Images&&s[o].Images.Primary&&s[o].Images.Primary.Medium&&s[o].Images.Primary.Medium.URL&&(b=s[o].Images.Primary.Medium.URL);var m="";s[o]&&s[o].Images&&s[o].Images.Primary&&s[o].Images.Primary.Small&&s[o].Images.Primary.Small.URL&&(m=s[o].Images.Primary.Small.URL);var f="-";s[o]&&s[o].Offers&&s[o].Offers.Listings[0]&&s[o].Offers.Listings[0].Price&&s[o].Offers.Listings[0].Price.DisplayAmount&&(f=s[o].Offers.Listings[0].Price.DisplayAmount);var h="-";s[o]&&s[o].BrowseNodeInfo&&s[o].BrowseNodeInfo.BrowseNodes&&s[o].BrowseNodeInfo.BrowseNodes[0]&&s[o].BrowseNodeInfo.BrowseNodes[0].SalesRank&&s[o].BrowseNodeInfo.BrowseNodes[0].ContextFreeName&&(h='<span class="alp-salesranking-rank">#'+s[o].BrowseNodeInfo.BrowseNodes[0].SalesRank+'</span><span class="alp-salesranking-category">in '+s[o].BrowseNodeInfo.BrowseNodes[0].ContextFreeName+"</span>"),l+='<div class="alp-tb-search-result" data-alp-chosen-result="no">',l+='<div class="alp-tb-search-result-inner">',l+='<div class="alp-tb-search-result-choose">',l+='<a class="js-amalinkspro-choose-product-for-tablebuilder" data-amalinkspro-item-title="'+p+'" data-amalinkspro-item-img-med="'+b+'" data-amalinkspro-item-asin="'+n+'" data-alp-item-url="'+d+'"><i class="icon-amalinkspro-ok"></i> Click to Select</a>',l+="</div>",l+='<div class="alp-tb-search-result-title">',l+=""+p,l+="</div>",l+='<div class="alp-tb-search-result-img">',l+='<img src="'+m+'" alt="'+p+'" />',l+="</div>",l+='<div class="alp-tb-search-result-salesrank">',l+=""+h,l+="</div>",l+='<div class="alp-tb-search-result-price">',l+="<div>"+f+"</div>",l+='<div class="alp-tb-search-result-prime">',l+=c,l+="</div>",l+="</div>",l+='<div class="alp-tb-search-result-link">',l+='<span><a class="amalinkspro-view-link" href="'+r+'" target="_blank">View Product</a></span>',l+="</div>",l+="</div>",l+="</div>"}}a("#amalinkspro-tablebuilder-search-results").html(l),a("#amalinkspro-tablebuilder-search-results").css("display","flex"),a(".amalinkspro-table-search-pagination").fadeIn(100)}else console.log("not json."),l='<p style="font-weight: bold;color: red;margin: 0 0 15px 0;">There was a problem with your API keys. Here is the response directly from Amazon:</p>',l+=t,a("#amalinkspro-tablebuilder-search-results").html(l),a("#amalinkspro-tablebuilder-search-results").fadeIn(100);else l+="There was a problem retreiving the data from Amazon."},complete:function(t){console.log("complated TB sarch"),a(".amalinkspro-tablebuilder-loading-overlay").fadeOut(300)}})}function b(t){var e=a("#alp-table.amalinkspro-comparison-table-admin");if(!e.find('thead tr th[data-alp-table-th-type="none"]').length){var l=e.find("thead tr:nth-child(2) th:not(:first-child)"),i=[];l.each(function(t){i[t]=a(this).attr("data-alp-table-th-type")});var s="";console.log("XXX0 - alp_api5_prods: "),console.log(t);var o=0,n=0;for(var r in t){s+='<tr class="new-asin-row" alp-data-asin="'+r+'" alp-data-url="'+t[r].detailPageURL+'">',s+="<td>",s+='<span class="icon-amalinkspro-drag" title="Drag Up or Down"></span>',s+='<label class="star-radio-label" title="Set as Top Choice">',s+='<input type="radio" name="alp-table-top-product" value="'+n+'" />',s+='<i class="icon-amalinkspro-star"></i>',s+="</label>",s+='<span class="icon-amalinkspro-trash js-alp-delete-row" title="Delete Row"></span>',s+="</td>";for(var d=1,p=i.length,d=0;d<p;d++){var c,b,m;console.log(i[d]),s+='<td class="alp-table-data-cell" data-alp-table-td-type="'+i[d]+'" style="vertical-align: '+a("table#alp-table thead tr.th-settings").find("th:nth-child("+d+")").attr("data-alp-table-v-align")+";text-align: "+a("table#alp-table thead tr.th-settings").find("th:nth-child("+d+")").attr("data-alp-table-h-align")+';"><i class="alp-js-load-row-data icon-amalinkspro-spin3 animate-spin"></i></td>'}s+="</tr>",n++}return console.log("new_row_template"),console.log(s),s}alert("You must add at least one column before adding products to your table.")}function m(t){var e="";console.log("asins_data: "),console.log(t);var l,i=a("#alp-table.amalinkspro-comparison-table-admin").find("tbody tr.new-asin-row");i&&i.each(function(e){var l=a(this).attr("alp-data-asin"),i=a(this).find("td.alp-table-data-cell");i&&i.each(function(e){var i=a(this).attr("data-alp-table-td-type");if(t&&l&&i){var s=f(t,l,i);if("price-list"===i||"price-offer"===i||"price-lowest-new-price"===i||"price-lowest-used-price"===i){var o=s.replace(/\D/g,"");a(this).attr("data-sort-value",o)}else if("image"===i){var o=s.replace(/\D/g,"");a(this).attr("data-sort-value",o)}else"cta-btn"===i?s='<span class="alp-table-td-ctabtn-editable">'+s+'<i class="icon-amalinkspro-edit"></i></span>':"custom"!==i&&"title"!==i&&"brand"!==i&&"model"!==i&&"manufacturer"!==i&&"upc"!==i&&"warranty"!==i&&"author"!==i&&"binding"!==i&&"edition"!==i&&"number-of-pages"!==i&&"publication-date"!==i&&"publisher"!==i&&"release-date"!==i&&"studio"!==i||(s='<span class="alp-table-td-editable">'+s+'<i class="icon-amalinkspro-edit"></i></span>')}a(this).html(s)})})}function f(t,e,l){var i="Error. You can add custom text here.";if(t&&t[e]){if(t[e].detailPageURL)var s=t[e].detailPageURL;else var s="#";if("title"===l)i=t[e].title?t[e].title:"-";else if("prime"===l)if(t[e].prime&&!0===t[e].prime)var i='<span class="alp-prime-eligible-tag"><span class="alp-prime-eligible-tag-top">Prime</span><span class="alp-prime-eligible-tag-bottom">Eligible</span></span>';else var i='<span class="alp-prime-eligible-tag not-eligible"><span class="alp-prime-eligible-tag-top">Prime</span></span>';else if("custom"===l)i="editable";else if("price-offer"===l||"price-list"===l)i=t[e].offerDisplay?'<span class="alp-price-offer">'+t[e].offerDisplay+"</span>":"N/A";else if("image"===l){if(t[e].ItemAttributes&&t[e].ItemAttributes.Title)var o=t[e].ItemAttributes.Title;else var o="Product Image";t[e].primaryImgUrlMd&&o?(i='<img src="'+t[e].primaryImgUrlMd+'" alt="'+o+'" data-img-id="medium" />',i+='<i class="icon-amalinkspro-edit js-edit-table-image" data-api-img="medium"></i>'):t[e].primaryImgUrlSm&&o?(i='<img src="'+t[e].primaryImgUrlSm+'" alt="'+o+'" data-img-id="small" />',i+='<i class="icon-amalinkspro-edit js-edit-table-image" data-api-img="small"></i>'):t[e].primaryImgUrlLg&&o?(i='<img src="'+t[e].primaryImgUrlLg+'" alt="'+o+'" data-img-id="large" />',i+='<i class="icon-amalinkspro-edit js-edit-table-image" data-api-img="large"></i>'):i="N/A"}else if("cta-btn"===l){var n;if(s)i='<a class="amalinkspro-cta-btn" href="'+s+'" target="_blank" rel="nofollow">'+a(".alp-table-title").attr("data-alp-cta-default")+"</a>";else i="Error: Delete this Row"}else i="brand"===l?t[e].brand?t[e].brand:"N/A":"model"===l?t[e].ItemAttributes&&t[e].ItemAttributes.Model?t[e].ItemAttributes.Model:"N/A":"warranty"===l?t[e].warranty?t[e].warranty:"N/A":"author"===l?t[e].ItemAttributes&&t[e].ItemAttributes.Author?t[e].ItemAttributes.Author:"N/A":"number-of-pages"===l?t[e].pagesCount?t[e].pagesCount:"N/A":"publication-date"===l?t[e].publicationDate?t[e].publicationDate:"N/A":"release-date"===l?t[e].releaseDate?t[e].releaseDate:"N/A":"custom"===l?"<span>Click to Edit</span>":"Invalid Type. You can add custom text here."}return i}a("body").on("click",".amalinkspro-close-tablebuilder-modal",function(t){t.preventDefault(),a("#amalinkspro-tablebuilder").fadeOut(50)}),a("body").on("click",".js-amalinkspro-launch-table-addon",function(t){t.preventDefault(),"none"==a(this).attr("data-alp-block")&&(a(".js-insert-table-shortcode-into-editor-from-all").show(),a(".js-insert-table-shortcode-into-block-from-all").hide()),a(this).hasClass("alp-open-tb-dash")?(a("#amalinkspro-tablebuilder").show(),a(".amalinkspro-close-tablebuilder-modal").hide(),a(".js-insert-table-shortcode-into-editor-from-all").hide(),a("#amalinkspro-media-window").fadeIn(100)):a("#amalinkspro-tablebuilder").fadeIn(100)}),a("body").on("click",".alp-close-popup-shortcode",function(){a(this).closest(".alp-posts-tr-td-shortcode").removeClass("shortcode-open")}),a("body").on("click",".alp-table-editor-add-row",function(){if(ALPglobal.AlpNoAPI&&ALPglobal.AlpNoAPI&&"noapi"===ALPglobal.AlpNoAPI){var t=a("table#alp-table"),e=a("table.amalinkspro-comparison-table-admin").find("tbody tr:first-child").clone();e.find(".alp-tb-noapi-row-link input[type=text]").val("");var l=e.find("td").not(":first-child").each(function(t){var e=a(this).attr("data-alp-table-td-type");if("cta-btn"===e){var l=a(".alp-table-title").attr("data-alp-cta-default");a(this).html('<span class="alp-table-td-ctabtn-editable"><a class="amalinkspro-cta-btn" href="#" target="_blank" rel="nofollow">Click Here</a><i class="icon-amalinkspro-edit"></i></span>')}else"image-sitestripe"===e?a(this).html('<i class="icon-amalinkspro-edit js-edit-table-image-sitestripe"></i><span class="alp-sitestripe-tb-col-html"></span>'):a(this).html('<span class="alp-table-td-editable"><span>Click to Edit</span><i class="icon-amalinkspro-edit"></i></span>')});t.find("tbody").append(e);var i=parseInt(t.attr("data-alp-table-rows")),s=0;t.find("tbody tr").each(function(a){s++}),t.attr("data-alp-table-rows",s)}else a("#alp-table, .alp-table-editor-add-column, .alp-table-editor-add-row").css("pointerEvents","none"),a("th.draggable").find(".alp-table-editor-col-settings").fadeOut(50),a(".amalinkspro-tablebuilder-search").fadeIn(300)}),a("body").on("click",".alp-js-close-tablebuilder-product-search",function(t){a(".amalinkspro-tablebuilder-search").fadeOut(50),a("#alp-table, .alp-table-editor-add-column, .alp-table-editor-add-row").css("pointerEvents","all")}),a("body").on("change",".alp-table-addcol-type",function(){var t=a(this).val();if("custom"===t)var e="Click to Edit";else if("image-sitestripe"===t)var e="Image";else if("price-list"===t)var e="Offer Price";else if("price-offer"===t)var e="Offer Price";else if("price-lowest-new-price"===t)var e="Lowest New Price";else if("price-lowest-used-price"===t)var e="Lowest Used Price";else if("image"===t)var e="Image";else if("cta-btn"===t)var e="Buy";else if("features"===t)var e="Features";else if("brand"===t)var e="Brand";else if("title"===t)var e="Title";else if("prime"===t)var e="Prime";else if("model"===t)var e="Model";else if("manufacturer"===t)var e="Manufacturer";else if("upc"===t)var e="upc";else if("warranty"===t)var e="Warranty";else if("name"===t)var e="Name";else if("author"===t)var e="Author";else if("binding"===t)var e="Binding";else if("edition"===t)var e="Edition";else if("number-of-pages"===t)var e="Pages";else if("publication-date"===t)var e="Publication Date";else if("publisher"===t)var e="Publisher";else if("release-date"===t)var e="Release Date";else if("studio"===t)var e="Studio";a("#alp-table-add-column").attr("data-alp-addcol-type",t),a("#alp-table-add-column").attr("data-alp-addcol-th-text",e),a(".alp-table-addcol-step3").is(":hidden")&&(a(".alp-table-addcol-step1").css({background:"none",minHeight:"inherit"}),a(".alp-table-addcol-step3").fadeIn(300))}),a("body").on("click",'.alp-table-editor-col-settings .alp-responsive input[type="checkbox"]',function(){"hide-on-mobile"===a(this).val()&&(a(this).is(":checked")?a("#alp-table-add-column").attr("data-alp-addcol-hide-sm","1"):a("#alp-table-add-column").attr("data-alp-addcol-hide-sm","0")),"hide-on-tablet"===a(this).val()&&(a(this).is(":checked")?a("#alp-table-add-column").attr("data-alp-addcol-hide-md","1"):a("#alp-table-add-column").attr("data-alp-addcol-hide-md","0")),"hide-on-desktop"===a(this).val()&&(a(this).is(":checked")?a("#alp-table-add-column").attr("data-alp-addcol-hide-lg","1"):a("#alp-table-add-column").attr("data-alp-addcol-hide-lg","0"))}),a("body").on("click",".alp-table-editor-add-column",function(){a("#alp-table, .alp-table-editor-add-column, .alp-table-editor-add-row").css("pointerEvents","none"),a("th.draggable").find(".alp-table-editor-col-settings").fadeOut(50),a("#alp-table-add-column").fadeIn(300)}),a("body").on("click",".alp-table-add-column .alp-js-close-col-settings",function(){a("#alp-table-add-column").fadeOut(300),"0"!==a("table#alp-table").attr("data-alp-table-cols")&&n(),a("#alp-table, .alp-table-editor-add-column, .alp-table-editor-add-row").css("pointerEvents","all")}),a("body").on("click",".alp-table-add-col-insert",function(){var t=a("#alp-table-add-column"),i=t.attr("data-alp-addcol-type"),s=t.attr("data-alp-addcol-th-text"),o=a(".alp-table-wrapper").attr("data-alp-table-new"),r=a("table#al-table").attr("data-alp-table-cols");if("1"===o||a("#alp-table").find("thead tr.no-table-rows").length){console.log("this is being called");var d=a("#alp-table"),p=a(".amalinkspro-comparison-table-admin").find("thead tr:first-child").find("th:last-child").clone();if(d.find("thead tr:first-child").append(p),ALPglobal.AlpNoAPI&&ALPglobal.AlpNoAPI&&"yesapi"===ALPglobal.AlpNoAPI){var c='<th data-alp-table-th-type="'+i+'">'+s+"</th>";d.find("thead tr:nth-child(2)").append(c);var b=a('<td class="no-data-yet" data-alp-table-td-type="'+i+'"><i class="icon-amalinkspro-emo-happy"></td>');d.find("tbody tr").append(b)}else{var c='<th data-alp-table-th-type="'+i+'"><span class="alp-table-th-editable">'+s+'<i class="icon-amalinkspro-edit" title="Edit Column Heading"></i></span></th>';if(d.find("thead tr:nth-child(2)").append(c),"cta-btn"===i)var m=a(".alp-table-title").attr("data-alp-cta-default"),f,h='<span class="alp-table-td-ctabtn-editable"><a class="amalinkspro-cta-btn" href="'+d.find("tbody tr td .alp-tb-noapi-row-link input[type=text]").val()+'" target="_blank" rel="nofollow">Click Here</a><i class="icon-amalinkspro-edit"></i></span>';else"image-sitestripe"===i?(h='<i class="icon-amalinkspro-edit js-edit-table-image-sitestripe"></i>',h+='<span class="alp-sitestripe-tb-col-html"></span>'):h='<span class="alp-table-td-editable"><span>Click to Edit</span><i class="icon-amalinkspro-edit"></i></span>';var b=a('<td data-alp-table-td-type="'+i+'">'+h+"</td>");d.find("tbody tr").append(b)}var u,g=(u=parseInt(a("table#alp-table").attr("data-alp-table-cols")))+1;a("table#alp-table").attr("data-alp-table-cols",g),a("#alp-table-add-column").fadeOut(300),a("#alp-table, .alp-table-editor-add-column, .alp-table-editor-add-row").css("pointerEvents","all"),n()}else{a("#alp-table").dragtable("destroy");var c='<th data-alp-table-th-type="'+i+'"><span class="alp-table-th-editable">'+s+'<i class="icon-amalinkspro-edit" title="Edit Column Heading"></i></span></th>',p=a(".amalinkspro-comparison-table-admin").find("thead tr:first-child").find("th:last-child").clone();a(".amalinkspro-comparison-table-admin").find("thead tr:first-child").append(p),a(".amalinkspro-comparison-table-admin").find("thead tr:nth-child(2)").append(c);var v="";if(a(".amalinkspro-comparison-table-admin").find("tbody tr").each(function(t){var e=a('<td class="no-data-yet" data-alp-table-td-type="'+i+'"></td>');e.append('<i class="alp-js-load-col-data icon-amalinkspro-spin3 animate-spin"></i>'),a(this).append(e),t>=1&&(v+=","),v+=a(this).attr("alp-data-asin")}),"0"===r)a("table#alp-table").attr("data-alp-table-cols","1");else{var u,g=(u=parseInt(a("table#alp-table").attr("data-alp-table-cols")))+1;a("table#alp-table").attr("data-alp-table-cols",g)}a("#alp-table-add-column").fadeOut(300),ALPglobal.AlpNoAPI&&ALPglobal.AlpNoAPI&&"yesapi"===ALPglobal.AlpNoAPI?l(v):e()}}),a("body").on("click",".js-edit-table-image-sitestripe",function(t,e){var l=a(this).closest("td").find(".alp-sitestripe-tb-col-html").html(),i="";l&&""!==l&&(i=l);var s='<div class="alp-tb-sitestripe-code-wrap">';s+='<textarea class="alp-tb-sitestripe-code-field" placeholder="INsert your SiteStripe Image Code Here">'+i+"</textarea>",s+='<span class="alp-insert-sitestripe-tb-col">Insert Image Code</span>',s+="</div>";var o=a(this).closest("td").html(s)}),a("body").on("click",".alp-insert-sitestripe-tb-col",function(t,e){var l=a(this).closest("td").find(".alp-tb-sitestripe-code-field").val();if(console.log("TB SiteStripe Code."),console.log("img_code: "+l),l&&""!==l){var i='<span class="alp-sitestripe-tb-col-html">';i+=l,i+="</span>",a(this).closest("td").prepend('<i class="icon-amalinkspro-edit js-edit-table-image-sitestripe"></i>'),a(this).closest("td").append(i)}else a(this).closest("td").prepend('<i class="icon-amalinkspro-edit js-edit-table-image-sitestripe"></i>');a(this).closest(".alp-tb-sitestripe-code-wrap").fadeOut(200).remove()}),a("body").on("click",".js-amalinkspro-add-table",function(){var t,e;"0"!==a("#alp-new-table-post-form").attr("data-alp-table-post-id")&&(1==confirm("This will reset the Table Builder to a new table.")&&(a(".amalinkspro-tablebuilder-loading-overlay").fadeIn(300),a("#alp-new-table-post-form").find("#new-alp-table-title").val(""),a(".amalinkspro-tablebuilder-table-post-editor-inner").find("h1").text("Create a New Table Table"),a(".amalinkspro-tablebuilder-table-post-editor-inner").find(".amalinkspro-add-table-btn").text("Save Table and Continue"),a("#alp-new-table-post-form").attr("data-alp-table-post-id","0"),a("#alp-new-table-post-form").find(".post-id").text("Table ID: 0").css("opacity","0")));a(".amalinkspro-tablebuilder-table-post-editor").fadeIn(50,function(){a(".amalinkspro-tablebuilder-loading-overlay").fadeOut(300)})}),a("body").on("click",".alp-js-cancel-new-table",function(t){t.preventDefault(),a(".amalinkspro-tablebuilder-table-post-editor").fadeOut(50)}),a("body").on("click",".alp-js-edit-table",function(t){var e=a(t.target);if(t.preventDefault(),!e.data("lockedAt")||+new Date-e.data("lockedAt")>3e3){a(".amalinkspro-tablebuilder-loading-overlay").fadeIn(300),a(".alp-table-wrapper.amalinkspro-tablebuilder-table").find("table#alp-table").length&&a(".alp-table-wrapper.amalinkspro-tablebuilder-table").find("table#alp-table").remove();var l=a(this).closest(".alp-posts-tr-td").attr("data-alp-table-id"),i="Editing Table "+a(this).closest(".alp-posts-tr").find(".alp-posts-tr-td:first-child > span").html();a(".amalinkspro-tablebuilder-table").attr("data-alp-table-id",l);var o={action:"amalinkspro_load_table_into_editor",table_id:l};a.ajax({type:"POST",url:ajaxurl,data:o,success:function(t){console.log("uncomment to load table response"),t&&(a(".alp-table-wrapper.amalinkspro-tablebuilder-table").prepend(t),a(".alp-table-wrapper.amalinkspro-tablebuilder-table").attr("data-alp-table-new","0"),a(".alp-table-editor-add-column").fadeIn(100),a(".alp-table-editor-add-column").fadeIn(100),a(".alp-table-editor-add-row").fadeIn(100),n(),r(),a("#amalinkspro-tablebuilder .amalinkspro-media-window-title").find("h1 .alp-tb-title-nonapi-tag").length?a("#amalinkspro-tablebuilder .amalinkspro-media-window-title").find("h1").html('<span class="alp-tb-title-nonapi-tag">Non-API Mode</span>'+i):a("#amalinkspro-tablebuilder .amalinkspro-media-window-title").find("h1").html(i))},complete:function(t){a(".amalinkspro-tablebuilder-tablebuilder, .amalinkspro-tablebuilder-sidebar").fadeIn(50,function(){}),"undefined"!=typeof tinymce&&null!=tinymce.activeEditor&&(a(".alp-insert-table-into-editor").show(),a(".alp-insert-table-into-gutenberg").hide()),window.amalinksproBlockType&&"alp-table-shortcode"===window.amalinksproBlockType&&(a(".alp-insert-table-into-editor").hide(),a(".alp-insert-table-into-gutenberg").show()),s(l),a(".amalinkspro-tablebuilder-loading-overlay").fadeOut(300)}})}e.data("lockedAt",+new Date)}),a("body").on("click",".alp-js-edit-table-settings",function(t){var e=a("#alp-new-table-post-form").attr("data-alp-table-post-id"),l=a("#alp-new-table-post-form").find("#new-alp-table-title").val();if("0"!==e||""!==l){var i;if(1==confirm("This will reset the Table Builder to the chosen table.")){var s=a(this).closest(".alp-posts-tr-td").attr("data-alp-table-id");a("#alp-new-table-post-form").attr("data-alp-table-post-id",s),a("#alp-new-table-post-form").find(".post-id").text("Table ID: "+s).css("opacity","1");var o={action:"amalinkspro_edit_table",table_post_id:s};a.ajax({type:"POST",url:ajaxurl,dataType:"json",data:o,success:function(t){t&&(a("#alp-new-table-post-form").find("#new-alp-table-title").val(t.post_title),a(".amalinkspro-tablebuilder-table-post-editor-inner").find(".amalinkspro-add-table-btn").text("Update Table"),a(".amalinkspro-tablebuilder-table-post-editor-inner").find("h1").text("Edit Table"))},complete:function(t){a(".amalinkspro-tablebuilder-table-post-editor").fadeIn(50)}})}}else{var s=a(this).closest(".alp-posts-tr-td").attr("data-alp-table-id");a("#alp-new-table-post-form").attr("data-alp-table-post-id",s),a("#alp-new-table-post-form").find(".post-id").text("Table ID: "+s).css("opacity","1");var o={action:"amalinkspro_edit_table",table_post_id:s};a.ajax({type:"POST",url:ajaxurl,dataType:"json",data:o,success:function(t){t&&(a("#alp-new-table-post-form").find("#new-alp-table-title").val(t.post_title),a(".amalinkspro-tablebuilder-table-post-editor-inner").find(".amalinkspro-add-table-btn").text("Update Table"),a(".amalinkspro-tablebuilder-table-post-editor-inner").find("h1").text("Edit Table"))},complete:function(t){a(".amalinkspro-tablebuilder-table-post-editor").fadeIn(50)}})}}),a("body").on("click",".alp-js-delete-table",function(t){var e;if(1==confirm("Are you sure? If you delete this table you cannot get it back. Make sure you have no shortcodes using it.")){var l=a(this).closest(".alp-posts-tr-td").attr("data-alp-table-id"),i;a("div.alp-posts-tr[data-alp-table-id="+l+"]").css("background","pink");var s={action:"amalinkspro_delete_table",table_post_id:l};a.ajax({type:"POST",url:ajaxurl,data:s,success:function(a){a?(console.log("success"),console.log(a)):(console.log("no response"),console.log(a))},complete:function(t){console.log("complete"),console.log(t);var e="div.alp-posts-tr[data-alp-table-id="+s.table_post_id+"]";a(e).fadeOut(300)}})}}),a("body").on("click",".alp-js-copy-table-shortcode",function(t){a(this).closest("div").find(".alp-posts-tr-td-shortcode").toggleClass("shortcode-open")}),a("body").on("click",".js-alp-table-alp_save_new_table",function(t){var e=a("#alp-new-table-post-form"),l=e.attr("data-alp-table-post-id"),i=e.find("#new-alp-table-title").val(),n=ALPglobal.AlpNoAPI;if(""!==l&&""!==i){a(".amalinkspro-tablebuilder-loading-overlay").fadeIn(300);var r={action:"amalinkspro_save_new_table",table_post_id:l,table_post_title:i,table_api_type:n},d="";a.ajax({type:"POST",url:ajaxurl,data:r,success:function(t){if(t){d=t,a("#alp-new-table-post-form").attr("data-alp-table-post-id",t),a("#alp-new-table-post-form").find(".post-id").text("Table ID: "+t).css("opacity","1"),
a(".alp-table-wrapper.amalinkspro-tablebuilder-table").attr("data-alp-table-id",t);var e='<div class="alp-posts-tr" data-alp-table-id="'+d+'">';e+='<div class="alp-posts-tr-td">',e+='<span class=""><span class="table-id">#'+d+" - </span> "+r.table_post_title+"</span>",e+="</div>",e+='<div class="alp-posts-tr-td">',e+="</div>",e+='<div class="alp-posts-tr-td">',e+='<span class="">today</span>',e+="</div>",e+='<div class="alp-posts-tr-td" data-alp-table-id="'+d+'">',e+="<div>",e+='<i class="icon-amalinkspro-edit alp-js-edit-table"></i>',e+='<i class="icon-amalinkspro-trash alp-js-delete-table"></i>',e+='<i class="icon-amalinkspro-cog alp-js-edit-table-settings"></i>',e+="</div>",e+="</div>",e+="</div>",a(".alp-posts").length?a(".alp-posts .alp-posts-tr:first-child").after(e):a(".alp-posts").prepend(e)}else alert("There was an Error. Your post may not have been saved."),console.log("ALERT: "+t)},complete:function(t){o(d,i),s(d),null!=tinymce.activeEditor&&(a(".alp-insert-table-into-editor").show(),a(".alp-insert-table-into-gutenberg").hide()),window.amalinksproBlockType&&"alp-table-shortcode"===window.amalinksproBlockType&&(a(".alp-insert-table-into-editor").hide(),a(".alp-insert-table-into-gutenberg").show())}})}else alert("You must give your table a name to save it.")}),a("body").on("click","#alp-table td .star-radio-label input[type=radio]",function(t){console.log("test 0"),console.log(a(this).closest("tr").attr("class")),a(this).closest("tr").hasClass("alp-featured-table-row")?(console.log("test 1"),a(".star-radio-label").find("input[type=radio]").prop("checked",!1),a("#alp-table tbody tr").removeClass("alp-featured-table-row")):(console.log("test 2"),a("#alp-table tbody tr").removeClass("alp-featured-table-row"),a(this).closest("tr").addClass("alp-featured-table-row"))}),a("body").on("change","#alp-table th .star-radio-label input[type=radio]",function(t){a("#alp-table tbody tr").removeClass("alp-featured-table-row")}),a("body").on("click",".js-alp-save-table-data",function(t){if(t.preventDefault(),a("#alp-table thead tr.no-table-rows").length&&ALPglobal&&ALPglobal.AlpNoAPI&&"yesapi"===ALPglobal.AlpNoAP)alert("You must add at least 1 row to save your table.");else{a(".amalinkspro-tablebuilder-loading-overlay").fadeIn(300);var e=a(".alp-table-wrapper.amalinkspro-tablebuilder-table"),l=a("table#alp-table"),i=e.attr("data-alp-table-id");if(l.length&&""!==i){var s=l.attr("data-alp-table-cols"),o=l.find("tr.th-settings th"),n=new Array;o.each(function(t){n[t]={hideForSm:a(this).attr("data-alp-table-hide-for-sm"),hideForMd:a(this).attr("data-alp-table-hide-for-md"),hideForLg:a(this).attr("data-alp-table-hide-for-lg"),verticalAlign:a(this).attr("data-alp-table-v-align"),horizontalAlign:a(this).attr("data-alp-table-h-align"),linkCell:a(this).attr("data-alp-table-col-link"),disableSort:a(this).attr("data-alp-table-col-disable-sort")}});var r=l.find("thead tr:nth-child(2) th"),d=new Array,p="",c="";r.each(function(t){p=a(this).attr("data-alp-table-th-type"),c="custom"===p||"title"===p||"brand"===p||"model"===p||"manufacturer"===p||"upc"===p||"warranty"===p||"author"===p||"binding"===p||"edition"===p||"number-of-pages"===p||"publication-date"===p||"publisher"===p||"release-date"===p||"studio"===p?a(this).find(".alp-table-th-editable").text():a(this).text(),d[t]={name:c,type:p,width:a(this).attr("data-alp-table-col-width")}});var b=l.attr("data-alp-table-rows"),m=l.find("tbody tr"),f=new Array,h="none";m.each(function(t){var e=a(this).attr("alp-data-asin");if(ALPglobal&&ALPglobal.AlpNoAPI&&"yesapi"===ALPglobal.AlpNoAPI)var l=a(this).attr("alp-data-url");else var l=a(this).find(".alp-tb-noapi-row-link input[type=text]").val();var i=a(this).find("td"),s=new Array,o="",n="",r="";a(this).hasClass("alp-featured-table-row")&&(h=t),i.each(function(t){if(r="",a(this).find("a.alp-top-pic").length?(console.log("top pic found"),a(this).find("a.alp-top-pic").remove().end()):console.log("top pic not found"),"custom"===(n=a(this).attr("data-alp-table-td-type"))||"title"===n||"brand"===n||"model"===n||"manufacturer"===n||"upc"===n||"warranty"===n||"author"===n||"binding"===n||"edition"===n||"number-of-pages"===n||"publication-date"===n||"publisher"===n||"release-date"===n||"studio"===n)a(this).find("i.icon-amalinkspro-edit").remove().end(),o=a(this).find(".alp-table-td-editable").text();else if("cta-btn"===n){var e;(e=a(this).clone()).find("i.icon-amalinkspro-edit").remove().end(),e.find("span.alp-top-pick").remove().end(),o=e.html()}else if("image"===n)a(this).find("i.icon-amalinkspro-edit").remove().end(),r=a(this).find("img").attr("data-img-id"),o=a(this).html();else if("image-sitestripe"===n){var e;(e=a(this).clone()).find("i.icon-amalinkspro-edit").remove().end(),e.find("span.alp-top-pick").remove().end(),o=e.html()}else o=a(this).html();s[t]={html:o,type:n,id:r}}),f[t]={rowSettings:"none",rowASIN:e,rowURL:l,rowCells:s}});var u=a(".amalinkspro-tablebuilder-sidebar").find(".amalinkspro-tablebuilder-sidebar-settings-basic"),g=u.find(".amalinkspro-table-choose-associate-id-select").val();if(u.find("input#alp-new-window").is(":checked"))var v="on";else var v="off";if(u.find("input#alp-nofollow").is(":checked"))var k="on";else var k="off";if(u.find("input#alp-addtocart").is(":checked"))var w="on";else var w="off";var y={tableId:i,lastSaved:"",columns_count:s,columns_settings:n,columns:d,rows_count:b,rows:f,affiliate_id:g,new_window:v,nofollow:k,addtocart:w,featured_row:h};console.log("table_data_to_save: "),console.log(y);var I={action:"amalinkspro_save_table_data",table_post_id:i,table_data_to_save:y};a.ajax({type:"POST",url:ajaxurl,dataType:"json",data:I,success:function(t){console.log("success"),"success"===t?(console.log("it saved."),console.log(t),a(".amalinkspro-tablebuilder-loading-overlay").fadeOut(300,function(){alert("Your table columns and rows have been saved.")})):(console.log("ALERT: "+t),a(".amalinkspro-tablebuilder-loading-overlay").fadeOut(300,function(){alert("Your table columns and rows have been saved.")}))},complete:function(t){console.log("complete"),a(".amalinkspro-tablebuilder-loading-overlay").fadeOut(300)}})}}}),a("body").on("click",".js-alp-preview-table",function(t){if(t.preventDefault(),a("#alp-table tbody tr.no-table-rows-tbody").length)alert("You must add at least one product to preview your table.");else{a(".amalinkspro-tablebuilder-loading-overlay").fadeIn(300),a("#alp-table").dragtable("destroy"),a(".js-alp-save-table-data").css({opacity:"0.2",pointerEvents:"none"}),a(".js-alp-back-all-tables").css({opacity:"0.2",pointerEvents:"none"}),a(".amalinkspro-tablebuilder-tablebuilder-inner").css("borderRight","5px dashed #dedede"),a(".amalinkspro-tablebuilder-tablebuilder").css("background","#ffffff"),a(this).text("End Preview").removeClass("js-alp-preview-table").addClass("js-alp-preview-table-end"),a(".amalinkspro-tablebuilder-sidebar-settings").slideDown(50);var e=a(".alp-table-wrapper.amalinkspro-tablebuilder-table table").clone();window.alp_table_clone_backup=e,e.removeClass("amalinkspro-comparison-table-admin-editor").addClass("amalinkspro-comparison-table-admin-preview"),e.find("thead tr.th-settings").remove(),e.find("thead tr th:first-child").remove(),e.find("thead tr th span").contents().unwrap(),e.find("thead tr th").find("i").remove(),e.find("tbody tr td span").removeClass("alp-table-th-editable"),e.find("tbody tr td:first-child").remove(),e.find("tbody tr td").find("i").remove(),a(".amalinkspro-tablebuilder-wrap").fadeOut(300),a(".amalinkspro-tablebuilder-preview-wrap").fadeIn(300,function(){a(".amalinkspro-tablebuilder-preview-wrap").html(e);var t=a(".amalinkspro-tablebuilder-preview-wrap").find("table#alp-table").footable()}),a(".amalinkspro-tablebuilder-loading-overlay").fadeOut(300)}}),a("body").on("click",".js-alp-preview-table-end",function(t){t.preventDefault(),a("#amalinkspro-tablebuilder-preview-wrap table#alp-table").remove(),a(".amalinkspro-tablebuilder-wrap").fadeIn(300),a(".amalinkspro-tablebuilder-preview-wrap").fadeOut(300),a(".amalinkspro-tablebuilder-tablebuilder-inner").css("borderRight","none"),a(".amalinkspro-tablebuilder-tablebuilder").css("background","#cac9c9"),a(".js-alp-save-table-data").css({opacity:"1",pointerEvents:"all"}),a(".js-alp-back-all-tables").css({opacity:"1",pointerEvents:"all"}),a(".js-alp-preview-table-end").text("Preview Table").removeClass("js-alp-preview-table-end").addClass("js-alp-preview-table"),n(),r()}),a("body").on("click",".js-alp-back-all-tables",function(t){var e;t.preventDefault(),confirm("Any unsaved changes will be lost. Continue?")&&(a(".amalinkspro-tablebuilder-manage").show(),a(".amalinkspro-tablebuilder-tablebuilder, .amalinkspro-tablebuilder-sidebar").fadeOut(50),a(".alp-table-wrapper.amalinkspro-tablebuilder-table").find("table#alp-table").remove(),a(".alp-table-editor-add-column").hide(),a(".alp-table-wrapper.amalinkspro-tablebuilder-table").attr({"data-alp-table-id":"0","data-alp-table-new":"1"}),a(".alp-table-wrapper.amalinkspro-tablebuilder-table table#alp-table").attr({"data-alp-table-cols":"0","data-alp-table-rows":"0"}),a("#amalinkspro-tablebuilder .amalinkspro-media-window-title").find("h1 .alp-tb-title-nonapi-tag").length?a("#amalinkspro-tablebuilder .amalinkspro-media-window-title").find("h1").html('<span class="alp-tb-title-nonapi-tag">Non-API Mode</span>Product Comparison Table Builder'):a("#amalinkspro-tablebuilder .amalinkspro-media-window-title").find("h1").html("Product Comparison Table Builder"),a(".amalinkspro-tablebuilder-sidebar-settings-basic").hide())}),a("body").on("click",".icon-amalinkspro-link",function(){a(this).closest("td").css("overflow","visible"),a(this).closest("td").find(".alp-tb-noapi-row-link").css("display","block")}),a("body").on("click",".alp-tb-noapi-row-link i",function(){a(this).closest("td").css("overflow","visible"),a(this).closest("td").find(".alp-tb-noapi-row-link").hide(),a(this).closest("tr").find(".amalinkspro-cta-btn").attr("href",a(this).closest(".alp-tb-noapi-row-link").find("input[type=text]").val())}),a("body").on("keyup",".alp-tb-noapi-row-link input[type=text]",function(t){var e;13===t.which&&(a(this).closest("td").css("overflow","visible"),a(this).closest("td").find(".alp-tb-noapi-row-link").hide(),a(this).closest("tr").find(".amalinkspro-cta-btn").attr("href",a(this).closest(".alp-tb-noapi-row-link").find("input[type=text]").val()))}),a("table#alp-table").find("thead tr.no-table-rows").length||(n(),r()),a("body").on("click",".alp-table-editor-col-settings .alp-table-editor-col-settings-responsive input[type=checkbox]",function(t){a(this).is(":checked")?(a(this).closest("label").addClass("checked"),"hide-on-mobile"===a(this).val()?a(this).closest("th").attr("data-alp-table-hide-for-sm","1"):"hide-on-tablet"===a(this).val()?a(this).closest("th").attr("data-alp-table-hide-for-md","1"):"hide-on-desktop"===a(this).val()&&a(this).closest("th").attr("data-alp-table-hide-for-lg","1")):(a(this).closest("label").removeClass("checked"),"hide-on-mobile"===a(this).val()?a(this).closest("th").attr("data-alp-table-hide-for-sm","0"):"hide-on-tablet"===a(this).val()?a(this).closest("th").attr("data-alp-table-hide-for-md","0"):"hide-on-desktop"===a(this).val()&&a(this).closest("th").attr("data-alp-table-hide-for-lg","0"));var e=a(this).index(),l="";"1"===a(this).closest("th").attr("data-alp-table-hide-for-sm")&&(l+="xs sm",l+=""),"1"===a(this).closest("th").attr("data-alp-table-hide-for-md")&&(l+=""===l?"md":" md"),"1"===a(this).closest("th").attr("data-alp-table-hide-for-lg")&&(l+=""===l?"lg xl":" lg xl"),a(".alp-table-headings").find("th:nth-child("+e+")").attr("data-breakpoints",l)}),a("body").on("click",".alp-table-editor-col-settings .alp-table-editor-col-settings-v-align input[type=radio]",function(t){a(this).closest("th").attr("data-alp-table-v-align",a(this).val()),a(".alp-table-editor-col-settings-v-align").find("i").css("opacity",.5),a(this).closest("label").find("i").css("opacity",1);var e=a(this).closest("th").index()+1;a("#alp-table tr.alp-table-headings th:nth-child("+e+")").css("verticalAlign",a(this).val()),a("#alp-table tbody tr td:nth-child("+e+")").css("verticalAlign",a(this).val())}),a("body").on("click",".alp-table-editor-col-settings .alp-table-editor-col-settings-h-align input[type=radio]",function(t){a(this).closest("th").attr("data-alp-table-h-align",a(this).val()),a(".alp-table-editor-col-settings-h-align").find("i").css("opacity",.5),a(this).closest("label").find("i").css("opacity",1);var e=a(this).closest("th").index()+1;a("tr.alp-table-headings th:nth-child("+e+")").css("textAlign",a(this).val()),a("#alp-table tbody tr td:nth-child("+e+")").css("textAlign",a(this).val())}),a("body").on("click",".alp-table-editor-col-settings .alp-table-editor-col-settings-additional input[value=link-cells]",function(t){a(this).is(":checked")?a(this).closest("th").attr("data-alp-table-col-link","1"):a(this).closest("th").attr("data-alp-table-col-link","0")}),a("body").on("click",".alp-table-editor-col-settings .alp-table-editor-col-settings-additional input[value=disable-sort]",function(t){var e=a(this).closest("th").index()+1;a(this).is(":checked")?(a(this).closest("th").attr("data-alp-table-col-disable-sort","1"),a("#alp-table thead").find("tr:nth-child(2) th:nth-child("+e+")").attr("data-sortable","false")):(a(this).closest("th").attr("data-alp-table-col-disable-sort","0"),a("#alp-table thead").find("tr:nth-child(2) th:nth-child("+e+")").attr("data-sortable","true"))}),a("body").on("click",".alp-table-editor-col-settings .alp-js-close-col-settings",function(){a(this).closest(".alp-table-editor-col-settings").fadeOut(50),a("#alp-table, .alp-table-editor-add-column, .alp-table-editor-add-row").css("pointerEvents","all")}),a("body").on("click",".amalinkspro-comparison-table-admin thead tr th .js-alp-column-settings",function(){a("th.draggable").find(".alp-table-editor-col-settings").hide(),a(this).closest("th").find(".alp-table-editor-col-settings").fadeIn(50)}),a("body").on("click",".js-alp-delete-column",function(){var t;if(confirm("Deleting this Column. Are you sure?")){var e=a(this).parent().index()+1;a("td, th",event.delegateTarget).remove(":nth-child("+e+")");var l,i=parseInt(a("table#alp-table").attr("data-alp-table-cols"))-1;a("table#alp-table").attr("data-alp-table-cols",i)}}),a("body").on("click",".js-alp-delete-row",function(){var t;if(confirm("Deleting this row. Are you sure?")){a(this).closest("tr").fadeOut(600,function(){a(this).remove()}),a("table tr").find("td:eq(n),th:eq(n)").remove();var e,l=parseInt(a("table#alp-table").attr("data-alp-table-rows"))-1;a("table#alp-table").attr("data-alp-table-rows",l)}}),a("body").on("click",".alp-col-settings-prev",function(){var t=parseInt(a(this).attr("data-alp-next-setting"));a(this).closest(".alp-table-editor-col-settings").find(".alp-table-editor-col-settings-slide").hide(),a(this).closest(".alp-table-editor-col-settings").find('[data-col-settings-slide="'+t+'"]').show(),2===t?(a(this).attr("data-alp-next-setting",1),a(".alp-col-settings-next").attr("data-alp-next-setting",3)):1===t?(a(this).attr("data-alp-next-setting",4),a(".alp-col-settings-next").attr("data-alp-next-setting",2)):3===t?(a(this).attr("data-alp-next-setting",2),a(".alp-col-settings-next").attr("data-alp-next-setting",1)):4===t&&(a(this).attr("data-alp-next-setting",3),a(".alp-col-settings-next").attr("data-alp-next-setting",1))}),a("body").on("click",".alp-col-settings-next",function(){var t=parseInt(a(this).attr("data-alp-next-setting"));a(this).closest(".alp-table-editor-col-settings").find(".alp-table-editor-col-settings-slide").hide(),a(this).closest(".alp-table-editor-col-settings").find('[data-col-settings-slide="'+t+'"]').show(),2===t?(a(this).attr("data-alp-next-setting",3),a(".alp-col-settings-prev").attr("data-alp-next-setting",1)):3===t?(a(this).attr("data-alp-next-setting",4),a(".alp-col-settings-prev").attr("data-alp-next-setting",3)):1===t?(a(this).attr("data-alp-next-setting",2),a(".alp-col-settings-prev").attr("data-alp-next-setting",3)):4===t&&(a(this).attr("data-alp-next-setting",1),a(".alp-col-settings-prev").attr("data-alp-next-setting",3))}),a("body").on("click",".js-amalinkspro-tablebuilder-search",function(t){a(".amalinkspro-tablebuilder-loading-overlay").fadeIn(300);var e=a(this).closest("p"),l=e.find("#amalinkspro-search-keyword-tablebuilder").val(),i=e.find("#amalinkspro-search-locale-tablebuilder").val(),s=a("#alp-api5-select-id-tables").val(),o;(console.log("aff_id: "+s),l)&&c({action:"alp_paapi5_get_products",term:l,locale:i,aff_id:s,page:"1"})}),a("body").on("keyup","#amalinkspro-search-keyword-tablebuilder",function(t){t.preventDefault();var e=t.which;if(console.log("key pressed"),console.log("key code: "+e),13===e){a(".amalinkspro-tablebuilder-loading-overlay").fadeIn(300);var l=a(this).closest("p"),i=l.find("#amalinkspro-search-keyword-tablebuilder").val(),s=l.find("#amalinkspro-search-locale-tablebuilder").val(),o=a("#alp-api5-select-id-tables").val(),n;if(!i)return;c({action:"alp_paapi5_get_products",term:i,locale:s,aff_id:o,page:"1"})}}),a("body").on("click",".alp-table-search-page",function(t){a(".amalinkspro-tablebuilder-loading-overlay").fadeIn(300);var e=a(this).closest(".amalinkspro-tablebuilder-search-inner"),l=e.find("#amalinkspro-search-keyword-tablebuilder").val(),i=e.find("#amalinkspro-search-locale-tablebuilder").val(),s=a("#alp-api5-select-id-tables").val(),o=a(this).attr("data-api-page"),n;l&&o?(c({action:"alp_paapi5_get_products",term:l,locale:i,aff_id:s,page:o}),a(".amalinkspro-table-search-pagination").find(".alp-table-search-page").removeClass("current"),a(this).addClass("current")):a(".amalinkspro-tablebuilder-loading-overlay").fadeOut(300)}),a("body").on("click",".js-amalinkspro-choose-product-for-tablebuilder",function(t){t.preventDefault();var e=a(this).closest(".alp-tb-search-result"),l=a(this).attr("data-amalinkspro-item-asin"),i=e.attr("data-alp-chosen-result"),s=a(".amalinkspro-tablebuilder-search").attr("data-alp-selected-products"),o="";"none"===s?"no"===i?(e.attr("data-alp-chosen-result","yes"),o=l):e.attr("data-alp-chosen-result","no"):"no"===i?(e.attr("data-alp-chosen-result","yes"),o=s+","+l):"yes"===i&&(e.attr("data-alp-chosen-result","no"),-1!==s.search(l)&&""===(o=(o=(o=s.replace(l,"")).replace(",,",",")).replace(/^,|,$/g,""))&&(o="none")),a(".amalinkspro-tablebuilder-search").attr("data-alp-selected-products",o);var n=a(".amalinkspro-tablebuilder-search").attr("data-alp-selected-products");"none"===n&&a(".amalinkspro-tablebuilder-search").find(".alp-js-insert-product-rows").is(":visible")?a(".amalinkspro-tablebuilder-search").find(".alp-js-insert-product-rows").fadeOut(300):"none"!==n&&a(".amalinkspro-tablebuilder-search").find(".alp-js-insert-product-rows").not(":visible")?a(".amalinkspro-tablebuilder-search").find(".alp-js-insert-product-rows").fadeIn(300):a(".amalinkspro-tablebuilder-search").find(".alp-js-insert-product-rows").fadeOut(300)}),a("body").on("click",".alp-js-insert-product-rows",function(t){t.preventDefault(),a("#alp-table, .alp-table-editor-add-column, .alp-table-editor-add-row").css("pointerEvents","none"),a(".amalinkspro-tablebuilder-loading-overlay").fadeIn(300),a("table#alp-table").find("tbody").data("ui-draggable")&&a("table#alp-table").find("tbody").sortable("destroy");var e=a(".amalinkspro-tablebuilder-search").attr("data-alp-selected-products");console.log("current_selected_asins: "+e),a(".amalinkspro-tablebuilder-search").fadeOut(100);var l=a("#alp-api5-select-id-tables").val();console.log("aff_id: "+l);var i={action:"alp_paapi5_get_asin_groups_data",asins:e,aff_id:l};a.ajax({type:"POST",url:ajaxurl,data:i,dataType:"json",success:function(t){if(console.log("success."),t){console.log("new api5 response: "),console.log(t),window.alpAPI5newTableRows=t;var e=b(t),l=a("#alp-table.amalinkspro-comparison-table-admin");l.find("tbody tr.no-table-rows-tbody").length?l.find("tbody").html(e):l.find("tbody").append(e),m(t)}a(".amalinkspro-tablebuilder-search").attr("data-alp-selected-products","none"),a(".alp-tb-search-result").attr("data-alp-chosen-result","no"),a(".alp-js-insert-product-rows").hide("")},complete:function(t){console.log("complete."),console.log(t),a("table#alp-table").find("tbody").data("ui-draggable")||r();var e=a("#alp-table.amalinkspro-comparison-table-admin"),l=parseInt(e.attr("data-alp-table-rows"));console.log("rows_count: "+l);var i=0,s=t.responseJSON;for(var o in s)i++;console.log("new_rows_count: "+i);var n=l+i;e.attr("data-alp-table-rows",n),a("#alp-table.amalinkspro-comparison-table-admin").find("tbody tr.new-asin-row").removeClass("new-asin-row"),a("#alp-table, .alp-table-editor-add-column, .alp-table-editor-add-row").css("pointerEvents","all"),a("#alp-table.amalinkspro-comparison-table-admin").find("thead tr").removeClass("no-table-rows").removeClass("no-table-rows-thead"),a(".amalinkspro-tablebuilder-loading-overlay").fadeOut(300)}})});var h=function(){var t=a("<input>",{val:a(this).text(),type:"text"});a(this).replaceWith(t),t.on("blur",u),t.select()},u=function(){var t=a("<span>",{text:a(this).val()});t.addClass("alp-table-th-editable"),a(this).replaceWith(t),t.append('<i class="icon-amalinkspro-edit" title="Edit Column Heading"></i>'),t.on("click",h)};a("body").on("click",".alp-table-th-editable",h),a("body").on("keyup","#alp-table th input",function(t){var e;if(13===t.which){var l=a("<span>",{text:a(this).val()});l.addClass("alp-table-th-editable"),a(this).replaceWith(l),l.append('<i class="icon-amalinkspro-edit" title="Edit Column Heading"></i>'),l.on("click",h)}});var g=function(){var t=a("<input>",{val:a(this).text(),type:"text",class:"alp-tb-cell-editable-input"});a(this).replaceWith(t),t.on("blur",v),t.select()},v=function(){var t=a("<span>",{text:a(this).val()});t.addClass("alp-table-td-editable"),a(this).replaceWith(t),t.append('<i class="icon-amalinkspro-edit" title="Edit Text"></i>'),t.on("click",g)};a("body").on("click",".alp-table-td-editable",g),a("body").on("keyup","#alp-table td input.alp-tb-cell-editable-input",function(t){var e;if(13===t.which){var l=a("<span>",{text:a(this).val()});l.addClass("alp-table-td-editable"),a(this).replaceWith(l),l.append('<i class="icon-amalinkspro-edit" title="Edit Text"></i>'),l.on("click",g)}});var k=function(){var t=a("<input>",{val:a(this).text(),type:"text",class:"alp-tb-cell-ctabtn-editable-input"});a(this).find(".icon-amalinkspro-edit").replaceWith(t),t.on("blur",w),t.select()},w=function(){a(this).closest("td").find("a.amalinkspro-cta-btn").text(a(this).val()),a(this).replaceWith('<i class="icon-amalinkspro-edit" title="Edit CTA Button Text"></i>')};function y(t,e,l){var i={action:"alp_paapi5_get_asin_groups_data",asins:t};a.ajax({type:"POST",url:ajaxurl,data:i,dataType:"json",success:function(t){console.log("response: "),console.log(t);var s=t,o=I(i.asin,s,e,l);a(".amalinkspro-tablebuilder-img-chooser-choices").html(o)},complete:function(a){}})}function I(a,t,e,l){var i="";for(var s in console.log("amalinksproChosenItem: "),console.log(t),t)if(console.log("variantsss: "),console.log(t[s].imgVariants),t[s]&&t[s].imgVariants){var o=t[s].imgVariants;for(var s in o){if(o[s].md)var n=o[s].md;else if(o[s].sm)var n=o[s].sm;i+='<div class="amalinkspro-choose-api-image">',i+='<img src="'+n+'" alt="" alp-table-img-id="'+s+'" />',i+='<div class="amalinkspro-choose-api-image-cover js-amalinkspro-select-image" data-row-index="'+e+'" data-cell-index="'+l+'" alp-table-img-id="'+s+'"></div>',i+="</div>"}i+='<div class="amalinkspro-clear"></div>'}else i+='<h3 class="amalinkspro-clear">Sorry, there are no image sets</h3>';return i}a("body").on("click",".alp-table-td-ctabtn-editable",k),a("body").on("keyup","#alp-table td input.alp-tb-cell-ctabtn-editable-input",function(t){var e;13===t.which&&(a(this).closest("td").find("a.amalinkspro-cta-btn").text(a(this).val()),a(this).replaceWith('<i class="icon-amalinkspro-edit" title="Edit CTA Button Text"></i>'))}),a("body").on("click",".js-insert-table-shortcode-into-block",function(t){t.preventDefault();var e=a(".amalinkspro-tablebuilder-sidebar").find(".amalinkspro-tablebuilder-sidebar-settings-basic"),l=a("table#alp-table").attr("data-alp-table-id"),i=e.find("select.amalinkspro-table-choose-associate-id-select").val();if(e.find("input#alp-new-window").is(":checked"))var s="on";else var s="off";if(e.find("input#alp-nofollow").is(":checked"))var o="on";else var o="off";if(e.find("input#alp-addtocart").is(":checked"))var n="on";else var n="off";var r='[amalinkspro_table id="'+l+'" aff-id="'+i+'" new-window="'+s+'" nofollow="'+o+'" addtocart="'+n+'" /]';console.log("amalinkspro_shortcode: "+r),window.alp_block_props?(window.alp_block_props.setAttributes({shortcode:r}),a(".amalinkspro-close-modal").click()):alert("You are not using the Block Editor.")}),a("body").on("click",".js-insert-table-shortcode-into-editor",function(t){t.preventDefault();var e=a(".amalinkspro-tablebuilder-sidebar").find(".amalinkspro-tablebuilder-sidebar-settings-basic"),l=a("table#alp-table").attr("data-alp-table-id"),i=e.find("select.amalinkspro-table-choose-associate-id-select").val();if(e.find("input#alp-new-window").is(":checked"))var s="on";else var s="off";if(e.find("input#alp-nofollow").is(":checked"))var o="on";else var o="off";if(e.find("input#alp-addtocart").is(":checked"))var n="on";else var n="off";var r='[amalinkspro_table id="'+l+'" aff-id="'+i+'" new-window="'+s+'" nofollow="'+o+'" addtocart="'+n+'" /]';null!=tinymce.activeEditor&&tinymce.activeEditor.execCommand("mceInsertContent",!1,r),a("#amalinkspro-media-window").fadeOut(100),a("#amalinkspro-close-modal").fadeOut(100),a("body").removeClass("scroll-locked")}),a("body").on("click",".js-insert-table-shortcode-into-block-from-all",function(t){t.preventDefault();var e,l,i,s,o,n='[amalinkspro_table id="'+a(this).closest(".alp-posts-tr").attr("data-alp-table-id")+'" aff-id="'+a(this).closest(".alp-posts-tr-td").attr("data-aff-id")+'" new-window="'+a(this).closest(".alp-posts-tr-td").attr("data-new-window")+'" nofollow="'+a(this).closest(".alp-posts-tr-td").attr("data-nofollow")+'" addtocart="'+a(this).closest(".alp-posts-tr-td").attr("data-addtocart")+'" /]';console.log("amalinkspro_shortcode: "+n),window.alp_block_props?(window.alp_block_props.setAttributes({shortcode:n}),a(".amalinkspro-close-modal").click()):alert("You are not using the Block Editor.")}),a("body").on("click",".js-insert-table-shortcode-into-editor-from-all",function(t){t.preventDefault();var e,l,i,s,o,n='[amalinkspro_table id="'+a(this).closest(".alp-posts-tr").attr("data-alp-table-id")+'" aff-id="'+a(this).closest(".alp-posts-tr-td").attr("data-aff-id")+'" new-window="'+a(this).closest(".alp-posts-tr-td").attr("data-new-window")+'" nofollow="'+a(this).closest(".alp-posts-tr-td").attr("data-nofollow")+'" addtocart="'+a(this).closest(".alp-posts-tr-td").attr("data-addtocart")+'" /]';null!=tinymce.activeEditor&&tinymce.activeEditor.execCommand("mceInsertContent",!1,n),a("#amalinkspro-media-window").fadeOut(100),a("#amalinkspro-close-modal").fadeOut(100),a("body").removeClass("scroll-locked")}),a("body").on("click",".alp-js-close-tablebuilder-img-chooser",function(t){a(".amalinkspro-tablebuilder-img-chooser").fadeOut(50),a(".amalinkspro-tablebuilder-img-chooser-choices").html('<div class="amalinkspro-loading-overlay"><span class="alp-spinner"></span></div>'),a("#alp-table, .alp-table-editor-add-column, .alp-table-editor-add-row").css("pointerEvents","all")}),a("body").on("click",".js-edit-table-image",function(t,e){a("#alp-table, .alp-table-editor-add-column, .alp-table-editor-add-row").css("pointerEvents","none"),a(".amalinkspro-tablebuilder-img-chooser").fadeIn(200);var l=a(this).attr("data-api-img"),i=a(this).closest("tr").attr("alp-data-asin"),s=a(this).closest("tr").index(),o=a(this).closest("td").index();ALPglobal&&ALPglobal.AlpNoAPI&&"yesapi"===ALPglobal.AlpNoAPI&&y(i,s,o)}),a("body").on("click",".amalinkspro-tablebuilder-img-chooser .js-amalinkspro-select-image",function(){var t=a(this).attr("alp-table-img-id"),e=a(this).closest(".amalinkspro-choose-api-image").find("img").attr("src"),l=a(this).attr("data-row-index"),i=a(this).attr("data-cell-index");a(this).closest(".amalinkspro-tablebuilder-img-chooser-choices").find(".amalinkspro-choose-api-image").removeClass("amalinkspro-chosen-api-img"),a(this).closest(".amalinkspro-choose-api-image").addClass("amalinkspro-chosen-api-img");var s,o,n="tbody tr:nth-child("+(parseInt(l)+1)+") td:nth-child("+(parseInt(i)+1)+")",r=a("table#alp-table").find(n);r.find("img").attr("src",e),r.find("img").attr("data-img-id",t),a(".amalinkspro-tablebuilder-img-chooser").fadeOut(50),a("#alp-table, .alp-table-editor-add-column, .alp-table-editor-add-row").css("pointerEvents","all")})})}(jQuery);
//# sourceMappingURL=amalinkspro-tables-admin-min.js.map